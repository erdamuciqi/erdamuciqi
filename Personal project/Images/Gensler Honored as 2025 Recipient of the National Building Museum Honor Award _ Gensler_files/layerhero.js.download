define(["jquery"],(function(e){function o(){(t=e(".about-hero:visible").first()).size()?((n=t.find(".layer-hero-wrapper")).data("loaded")||n.fadeTo(0,0).css("visibility","visible"),a=t.find(".hero-overlay")):t=!1}function i(){if(t&&t.size()){var e=a.width();e<=678?t.height(e).css("min-height",0):t.height("auto").css("min-height","")}else o()}function r(){if(t=!1,e(window).off("resize.layerhero"),o(),t){e(window).on("resize.layerhero",i),t.on("click",".caption-toggle",(function(){t.find(".hero-caption").toggleClass("hidden"),e(this).toggleClass("icon-cancel icon-align-left")}));var r=t.find("img"),a=function(){n.data("loaded",!0).fadeTo(300,1),t&&t.find(".hero-loader").remove(),e(this).removeClass("lazyhero").off("load.layerhero"),e(window).trigger("resize.layerhero")};r.size()?(r.off(".layerhero").on("load.layerhero error.layerhero",(function(){""!==r.attr("src")&&a.call(this)})).each((function(){this.complete&&e(this).load()})),e(window).off("picturefillComplete.layerhero").on("picturefillComplete.layerhero",(function(){""===r.attr("src")&&r.lazyload({effect:"show",effect_speed:0})}))):a(),window.picturefill(),setTimeout((function(){i()}),300)}}var t,n,a;return{start:function(){r(),e(window).on("tabchange.layerhero",r)},checkHero:r}}));